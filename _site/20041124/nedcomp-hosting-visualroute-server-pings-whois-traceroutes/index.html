<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]--><!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]--><!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]--><!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]--><!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]--><head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
  <title>How to find out who is sending you spam using email headers and visual route</title>
  <meta name="description" content="Pintmaster.com - I'm having all that's in the bubble in the bottom of the bottle">
	<meta name="author" content="Colin Nederkoorn">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" href="/favicon.ico">
	<link rel="apple-touch-icon" href="/apple-touch-icon.png">
	<link rel="stylesheet" href="/css/style.css?v=2">
	<link rel="stylesheet" media="handheld" href="/css/handheld.css?v=2">
	<script src="/js/libs/modernizr-1.7.min.js"></script></head>
<body>
	<div id="container">
		<header>
    <a href="/">Pintmaster</a>
		</header>

		<div id="main" role="main">
      <div id="post">
<h1>How to find out who is sending you spam using email headers and visual route</h1>  
<p>A lot of spam these days has spoofed headers. Some of the spam I receive says it is coming from me to me, or even from the people I do business with. We can examine the email header to determine who actually sent the email.</p>

<ol>
    <li>Open your email client and find a spam message - shouldnt be hard these days. The one I will be using claims to be from Suntrust Bank and looks like this:<br><img src="http://www.pintmaster.com/wordpress/wp-content/suntrust.png" alt="Suntrust Phishing Scam" /> </li>
    <li>I use Outlook 2003 at work so as you can guess, finding the headers is a little less intuitive than other email clients. First, double click on the email to open it in a separate window. Then, click "View -> Options". You should have an email header that looks something like this:
<code>
Microsoft Mail Internet Headers Version 2.0
Priority: normal
Importance: normal
thread-index: AcTFH98jKHBYsxN5RGKIBDEI/WSbTA==
X-iHateSpam-Quarantined: Quarantined by iHateSpam Server Edition (389)
Content-Transfer-Encoding: 7bit
Content-Class: urn:content-classes:message
Received: from my1.email.net ([11.111.111.111]) by my2.email.net with Microsoft SMTPSVC(6.0.3790.211); Sun, 7 Nov 2004 18:16:26 -0500
Received: from <strong>80.117.48.160 ([80.117.48.160])</strong> by my1.email.net with Microsoft SMTPSVC(5.0.2195.6713); Sun, 7 Nov 2004 18:16:23 -0500
From: "SunTrust bank" < -support56@suntrust.com>
To: <netco @netcousa.com>
Subject: SunTrust Bank Online
Date: Mon, 8 Nov 2004 12:16:19 +0100
MIME-Version: 1.0
Content-Type: multipart/related;
    type="multipart/alternative";
    boundary="----p5940362j9160295h3829588q7938T27"
X-Mailer: AOL 7.0 for Windows US sub 118
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.181
Return-Path: <w4e95015 @earthlink.net>
Message-ID: (ex2ger4uis42nxhwgrr000011c4 @ex2.callihq.net )
X-OriginalArrivalTime: 07 Nov 2004 23:16:24.0157 (UTC) FILETIME=[CCAA08D0:01C4C51F]
... More stuff down here...</w4e95015></netco></></code>
</li>
    <li>What we are looking for is the IP address of the spammer or the spam relay that sent the email to us. We can see that it is <code>80.117.48.160</code> because this is the address that doesnt belong to our email server and it is also the original server that our server received the email from.</li>
    <li>Now for the fun part! (2004/11/29 EDIT - Visualroute server is no longer there, possible to use ip2location.com)Lets put their IP address into the <a href="http://www.ip2location.com/free.asp">IP2Location</a> to see where they hang out. <br><img src="http://www.pintmaster.com/wordpress/wp-content/visualroute.png" alt="VisualRoute Image" />
It looks like this email most likely came from Milan, Italy.  So now you have a way to track down who is sending you emails by their geographical location
 
</li></ol>


<p>How to use this information<ul></p>

<pre><code>&lt;li&gt;&lt;a href="http://www.senderbase.org/search?searchString=interbusiness.it"&gt;Check interbusiness.it in Senderbase&lt;/a&gt; - a website to check out how much email they send - From there you can find the abuse email address and send them an copy of the &lt;strong&gt;email header&lt;/strong&gt; you received. It is important to send the header because they will not be able to track down the spammers without their IP address that is in the header. If they are decent, they will deal with the spammers, if not your time has been wasted.&lt;/li&gt;
</code></pre>

<p></ul></p>

</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'pintmaster'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    // var disqus_identifier = 'unique_dynamic_id_1234';
    // var disqus_url = 'http://example.com/permalink-to-page.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>


		</div>

		<footer>
      <a href="http://iamnotaprogrammer.com">Colin Nederkoorn</a>
		</footer>
	</div>

	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
	<script>!window.jQuery && document.write(unescape('%3Cscript src="js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
	<script src="/js/plugins.js"></script>
	<script src="/js/script.js"></script>
	<!--[if lt IE 7 ]>
	<script src="js/libs/dd_belatedpng.js"></script>
	<script> DD_belatedPNG.fix('img, .png_bg');</script>
	<![endif]-->
	<script>
		var _gaq=[['_setAccount','UA-840926-1],['_trackPageview']]; // Change UA-XXXXX-X to be your site's ID
		(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
		g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
		s.parentNode.insertBefore(g,s)}(document,'script'));
	</script></body>
</html>